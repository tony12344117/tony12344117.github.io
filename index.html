<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ¥’ ì˜¤ì´ í† ìŠ¤íŠ¸</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9;
      margin: 0;
    }
    header {
      background-color: #a3d977;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      color: white;
    }
    #container {
      display: flex;
    }
    #sidebar {
      width: 200px;
      background-color: #def8cc;
      height: 100vh;
      padding-top: 1rem;
    }
    #sidebar button {
      display: block;
      margin: 1rem;
      padding: 0.5rem;
      width: 80%;
      border: none;
      background-color: #c7efb2;
      cursor: pointer;
    }
    #main {
      flex-grow: 1;
      padding: 1rem;
    }
    .hidden {
      display: none;
    }
    .user-entry {
      margin: 0.5rem 0;
    }
    input, textarea {
      margin-top: 0.5rem;
      display: block;
      padding: 0.5rem;
      width: 100%;
      max-width: 300px;
    }
    textarea {
      resize: none;
    }
    .emoji {
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <header>ğŸ¥’ ì˜¤ì´ í† ìŠ¤íŠ¸</header>
  <div id="container">
    <div id="sidebar">
      <button onclick="showSection('balance')">í˜„ì¬ ì”ì•¡</button>
      <button onclick="showSection('send')">ì†¡ê¸ˆ</button>
      <button onclick="showSection('deposit')">ì…ê¸ˆ</button>
      <button onclick="showSection('withdraw')">ì¶œê¸ˆ</button>
      <button onclick="showSection('ranking')">ìˆœìœ„í‘œ</button>
      <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
    <div id="main">
      <div id="auth">
        <h2>ğŸ¥’ ì˜¤ì´ í† ìŠ¤íŠ¸ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤</h2>
        <p><strong>ì‹¤ëª… ë¬´ì¡°ê±´ ì‚¬ìš©í•˜ì„¸ìš”!</strong></p>
        <input type="text" id="authName" placeholder="ì´ë¦„ (ì‹¤ëª…)" />
        <input type="password" id="authPass" placeholder="ë¹„ë°€ë²ˆí˜¸" />
        <button onclick="register()">ê³„ì • ë§Œë“¤ê¸°</button>
        <p>ì´ë¯¸ ê³„ì •ì´ ìˆë‚˜ìš”?</p>
        <button onclick="login()">ë¡œê·¸ì¸</button>
      </div>

      <div id="app" class="hidden">
        <h2>í™˜ì˜í•©ë‹ˆë‹¤ ğŸ¥’ <span id="currentUser"></span>ë‹˜!</h2>
        <div id="balance" class="hidden"></div>
        <div id="send" class="hidden">
          <h3>ğŸ¥’ ì†¡ê¸ˆ</h3>
          <select id="recipientList"></select>
          <input type="number" id="sendAmount" placeholder="ê¸ˆì•¡" />
          <textarea id="sendMsg" maxlength="80" placeholder="ë©”ì‹œì§€ (ìµœëŒ€ 80ì)"></textarea>
          <button onclick="sendMoney()">ğŸ¥’ ì†¡ê¸ˆí•˜ê¸°</button>
        </div>
        <div id="deposit" class="hidden">í•™êµì—ì„œ ì‚¬ì—…ì‹œê°„ì— ì •í›„êµí•œí…Œ ì°¾ì•„ì™€ì„œ ë§í•˜ì„¸ìš” ğŸ¥’</div>
        <div id="withdraw" class="hidden">í•™êµì— ì™€ì„œ ì •í›„êµí•œí…Œ ë§í•˜ì„¸ìš” ğŸ¥’</div>
        <div id="ranking" class="hidden">
          <h3>ğŸ¥’ ìœ ì € ìˆœìœ„í‘œ</h3>
          <ul id="rankList"></ul>
        </div>
        <div id="adminPanel" class="hidden">
          <h3>ğŸ¥’ ë§ˆìŠ¤í„° ê´€ë¦¬ì íŒ¨ë„</h3>
          <select id="adminUserList"></select>
          <input type="number" id="adminAdjust" placeholder="ì¡°ì •í•  ê¸ˆì•¡ (+/- í¬í•¨)" />
          <button onclick="adjustBalance()">ğŸ¥’ ì˜¤ì´ ì¡°ì •</button>
          <button onclick="toggleBan()">ğŸ¥’ ê³„ì • ì •ì§€/í•´ì œ</button>
          <h4>ğŸ¥’ ì „ì²´ ê±°ë˜ ë‚´ì—­</h4>
          <pre id="logOutput"></pre>
        </div>
      </div>
    </div>
  </div>
  <script>
    const master = { id: 'ì •í›„êµ', pass: '302118' };
    let users = JSON.parse(localStorage.getItem('users') || '{}');
    let logs = JSON.parse(localStorage.getItem('logs') || '[]');
    let current = null;

    function save() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('logs', JSON.stringify(logs));
    }

    function register() {
      const name = document.getElementById('authName').value;
      const pass = document.getElementById('authPass').value;
      if (!name || !pass) return alert('ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
      if (users[name]) return alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë¦„ì…ë‹ˆë‹¤');
      users[name] = { pass, balance: 0, banned: false };
      save();
      alert('ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
    }

    function login() {
      const name = document.getElementById('authName').value;
      const pass = document.getElementById('authPass').value;
      if (!users[name] && !(name === master.id && pass === master.pass)) return alert('ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤');
      if (name !== master.id && users[name].pass !== pass) return alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤');
      if (users[name]?.banned) return alert('ì´ ê³„ì •ì€ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤');
      current = name;
      document.getElementById('auth').classList.add('hidden');
      document.getElementById('app').classList.remove('hidden');
      document.getElementById('currentUser').innerText = name;
      updateRecipientList();
      updateRanking();
      if (name === master.id) document.getElementById('adminPanel').classList.remove('hidden');
    }

    function logout() {
      current = null;
      document.getElementById('app').classList.add('hidden');
      document.getElementById('auth').classList.remove('hidden');
    }

    function showSection(id) {
      ['balance', 'send', 'deposit', 'withdraw', 'ranking'].forEach(s => {
        document.getElementById(s).classList.add('hidden');
      });
      document.getElementById(id).classList.remove('hidden');
      if (id === 'balance') document.getElementById('balance').innerText = `ğŸ¥’ ì”ì•¡: ${users[current]?.balance ?? 0} ì˜¤ì´`;
    }

    function updateRecipientList() {
      const sel = document.getElementById('recipientList');
      const adminSel = document.getElementById('adminUserList');
      sel.innerHTML = '';
      adminSel.innerHTML = '';
      Object.keys(users).forEach(name => {
        if (name !== current) sel.innerHTML += `<option>${name}</option>`;
        adminSel.innerHTML += `<option>${name}</option>`;
      });
    }

    function sendMoney() {
      const to = document.getElementById('recipientList').value;
      const amount = parseInt(document.getElementById('sendAmount').value);
      const msg = document.getElementById('sendMsg').value;
      if (!amount || amount <= 0 || !msg || msg.length > 80) return alert('ìœ íš¨í•œ ê¸ˆì•¡ê³¼ 80ì ì´ë‚´ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
      if (users[current].balance < amount) return alert('ì”ì•¡ ë¶€ì¡±');
      users[current].balance -= amount;
      users[to].balance += amount;
      logs.push(`${current} â†’ ${to} : ${amount}ğŸ¥’ | ë©”ì‹œì§€: ${msg}`);
      save();
      alert('ì†¡ê¸ˆ ì™„ë£Œ');
    }

    function adjustBalance() {
      const name = document.getElementById('adminUserList').value;
      const amount = parseInt(document.getElementById('adminAdjust').value);
      if (!amount) return alert('ê¸ˆì•¡ ì…ë ¥');
      users[name].balance += amount;
      logs.push(`ğŸ› ï¸ ë§ˆìŠ¤í„°ê°€ ${name}ì˜ ì˜¤ì´ë¥¼ ${amount > 0 ? '+' : ''}${amount}ğŸ¥’ ${amount > 0 ? 'ì¶”ê°€' : 'ì°¨ê°'}`);
      save();
      alert('ì¡°ì • ì™„ë£Œ');
    }

    function toggleBan() {
      const name = document.getElementById('adminUserList').value;
      users[name].banned = !users[name].banned;
      logs.push(`ğŸš« ë§ˆìŠ¤í„°ê°€ ${name} ê³„ì •ì„ ${users[name].banned ? 'ì •ì§€' : 'í•´ì œ'}ì‹œí‚´`);
      save();
      alert(users[name].banned ? 'ì •ì§€ë¨' : 'ì •ì§€ í•´ì œë¨');
    }

    function updateRanking() {
      const sorted = Object.entries(users).sort((a, b) => b[1].balance - a[1].balance);
      const list = document.getElementById('rankList');
      list.innerHTML = '';
      sorted.forEach(([name, data]) => {
        list.innerHTML += `<li>${name}: ${data.balance}ğŸ¥’</li>`;
      });
      document.getElementById('logOutput').innerText = logs.join('\n');
    }
  </script>
</body>
</html>
